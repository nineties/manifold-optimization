<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Manifold Optimization</title><link>https://nineties.github.io/manifold-optimization/</link><description>Recent content on Manifold Optimization</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><atom:link href="https://nineties.github.io/manifold-optimization/index.xml" rel="self" type="application/rss+xml"/><item><title>1. モチベーション</title><link>https://nineties.github.io/manifold-optimization/1-motivation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/1-motivation/</guid><description>ロボットが自分の姿勢を推定するという問題を考える。これは例えばオドメトリーの値やコンパスや加速度センサなどの値、カメラで検出したランドマークの座標などの情報を元にして計算される何らかのコスト関数を最小化する問題として表現される。
例えば、ロボットの姿勢が単位ベクトル $\mathbf{v}\in\mathbb{R}^3,||\mathbf{v}||=1$ で表されるとすると、実数値のコスト関数 $f$ に対して $f(\mathbf{v})$ が最小になる $\mathbf{v}$ は何か？という問題になる。
この事は、ユークリッド空間 $\mathbb{R}^3$ 上の実数値関数 $f:\mathbb{R}^3\rightarrow\mathbb{R}$ に対する 制約付き最適化問題
$$ \min_{\mathbf{x}\in\mathbb{R}^3}\ f(\mathbf{x})\quad\text{subject to}\quad ||\mathbf{x}||=1 $$
として表現出来るが、 制約条件がある為、ニュートン法などの反復解法を単純に用いることは出来ない。
上記の制約条件は $\mathbf{x}$ が単位球面 $ S^2 := \{\mathbf{x}\in\mathbb{R}^3\mid||\mathbf{x}||=1\} $ の点であると言い換える事ができる。つまり、ユークリッド空間上の制約付き最適化問題から、多様体 $S^2$ 上での制約なし最適化問題
$$ \min_{\mathbf{x}\in S^2}\ f(\mathbf{x}) $$
に問題を読み換える事ができる。
このような感じで、他にも様々な問題が 多様体上の最適化問題 に帰着する。 多くの問題では今の例よりパラメータ数が多く、球面のように想像しやすい空間でもない。 このような問題をどのように取り扱うのかを学んでいくのが本ノートの目的である。</description></item><item><title>10. 直線探索</title><link>https://nineties.github.io/manifold-optimization/10-linesearch/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/10-linesearch/</guid><description>続いて、レトラクションを用いた直線探索の更新式
$$ x_{k+1} = R_{x_k}(t_kv_k) $$
の 探索方向(search direction) $v_k$ と、 ステップサイズ(step size) $t_k$ をどのように選ぶべきかについて調べる。 これらは反復法が収束する事や収束先が停留点であるといった性質を持つように選ぶ必要がある。
ところで、多様体上の点列が収束するとはそもそもどういう事かというところから確認していく。
定義10.1: 点列の収束(チャートを用いた定義) 多様体 $\mathcal{M}$ 上の点列 $\{x_k\}$ に対して、あるチャート $(U,\psi)$ と点 $x_{\ast} \in U$ が存在し、ある自然数 $K$ について $k &amp;gt; K$ ならば $x_k \in U$ であり、$\psi(x_k)$ が $\psi(x_\ast)$ に収束するならば、 $\{x_k\}$ は 収束する (convergent) という。 また、 $$ \psi^{-1}(\lim_{k\rightarrow\infty} \psi(x_k)) $$ を $\{x_k\}$ の 極限(limit) といい、 $\lim_{k\rightarrow\infty}x_k$ と書く。
また $\{x_k\}$ の適当な部分列が $x\in\mathcal{M}$ に収束するならば $x$ をこの点列の 極限点(limit point) と呼び、 $\{x_k\}$ の極限点の集合を 極限集合(limit set) という。</description></item><item><title>2. 多様体の定義</title><link>https://nineties.github.io/manifold-optimization/2-manifold/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/2-manifold/</guid><description>Absil本では、(私が)よく見る定義とは異なり 極大アトラス を用いて多様体の定義を行なっている。 よくある定義では多様体 $\mathcal{M}$ の位相構造が天下り的に与えられる事が多いが、極大アトラスを用いた定義では $\mathcal{M}$ は単なる集合として導入されて極大アトラスによってその位相構造が自然と定まるという順番になる。
最初はこの定義を見て戸惑ったが、これから謎の空間 $\mathcal{M}$ を多様体と見なして調べようと言う時に、その位相構造が最初から分かっているという前提は強すぎるかもしれない。 極大アトラスを用いる定義はより抽象的で難易度が高いと感じたが、実際に問題を解く上でも$\mathcal{M}$の位相構造を所与とするより便利であるように思う。 このノートでも、Absil本の方針に従った定義を採用する。
定義2.1: チャート $\mathcal{M}$を集合とする。$\mathcal{M}$の部分集合 $U$からユークリッド空間 $\mathbb{R}^d$ の開集合$V$ への全単射 $\varphi:U\rightarrow V$がある時 $(U,\varphi)$を$\mathcal{M}$の$d$次元の チャート(chart) という。誤解の恐れのない場合には $U$ や $\varphi$ の事を単体でチャートと呼ぶこともある。
点 $x\in U$ に対して $\varphi(x)\in\mathbb{R}^d$ を $x$ のチャート $\varphi$ における 座標(coordinate) と言う。
チャートで、$\mathcal{M}$ の局所的な様子をより調べやすい空間であるユークリッド空間 $\mathbb{R}^d$ に写しとる事で、 $\varphi(U)$ を通して $U$ について調べることが可能になる。
これは例えば $\mathcal{M}$ を地球、 チャートをある一地方の地図だと思うとイメージしやすい。地球そのものを直接観察するよりは、地図を観察する方が易しい。
定義2.2: チャートの両立 2つの $d$次元チャート $(U,\varphi),(V,\psi)$ に対して
$$ \psi\circ\varphi^{-1}: \varphi(U\cap V)\rightarrow\psi(U\cap V) $$
を 座標変換(change of coordinates) という。</description></item><item><title>3. 多様体の位相構造</title><link>https://nineties.github.io/manifold-optimization/3-topology/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/3-topology/</guid><description>すでに述べたように、このノートでは多様体の位相は天下り的に与えられるのではなくて、極大アトラスによって定められる。その構成方法と構造について見ていく。
多くの多様体の定義では位相空間としてハウスドルフかつ第二可算(もしくはパラコンパクト)である事が仮定される事が多いが、 定義2.9 のように定義された多様体の極大アトラスが定める位相もこれらの性質を持つ事が言える。
ハウスドルフ空間であるので、多様体上の点列が収束するならばその極限は一意に定まる事が保証される。第二可算性やパラコンパクト性がどう嬉しいかは私も勉強中なのでまだよく分かっていない。後ほど使う場面でわかるだろう。
定義3.1: 開集合 多様体 $\mathcal{M}$ の部分集合 $U\subset \mathcal{M}$ が$\mathcal{M}$の 開集合(open subset) であるとは、任意のチャート $(V,\varphi)$ について $\varphi(U\cap V)$ が開集合である事をいう。
$U$ が開集合であるというのは、どの地図上でその部分を見ても開集合になっているという事。
命題3.2 集合 $\mathcal{M}$ の極大アトラスの定める開集合の族は開集合の公理を満たす。すなわち、
$\mathcal{M},\emptyset$ は開集合 $U,V$ が開集合ならば $U\cap V$ も開集合 $\{U_\alpha\}$が開集合ならば$\bigcup_\alpha U_\alpha$ も開集合 証明
$\mathcal{M},\emptyset$ が$\mathcal{M}$の開集合となる事は明らか。
$U,V$ が開集合であるならば、任意のチャート $(W,\varphi)$ に対して
$$\varphi((U\cap V)\cap W) = \varphi((U\cap W)\cap (V\cap W)) = \varphi(U\cap W)\cap\varphi(V\cap W)\quad\text{($\because \varphi$は全単射)}$$
であるので $\varphi(U\cap W),\varphi(V\cap W)$ が $\mathbb{R}^d$ の開集合である事より $\varphi((U\cap V)\cap W)$ も$\mathbb{R}^d$の開集合。従って $U\cap V$ は $\mathcal{M}$の開集合。</description></item><item><title>4. 可微分写像、部分多様体</title><link>https://nineties.github.io/manifold-optimization/4-submanifold/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/4-submanifold/</guid><description>多様体と多様体の関係性について調べたりする時に、それらの間の写像 $F:\mathcal{M}\rightarrow\mathcal{N}$ について考える。多様体ではその微分構造に関心があるので $F$ も何らかの微分可能な写像を考える必要があるが、一般の多様体上で定義された $F$ の微分可能性を直接述べるのは難しい。そこで、チャートを利用する。
定義4.1: 座標表示 $m$次元多様体 $\mathcal{M}$ と $n$次元多様体$\mathcal{N}$ の間の写像 $F:\mathcal{M}\rightarrow\mathcal{N}$ と点 $x\in \mathcal{M}$ に対して、
$x$ を含む $\mathcal{M}$ のチャート $\varphi:U\rightarrow \varphi(U),\ x\in U$ と $F(x)$ を含む $\mathcal{N}$ のチャート $\psi:V\rightarrow \psi(V),\ x\in V$ を用いた写像
$$ \hat{F}=\psi\circ F\circ\varphi^{-1}:\mathbb{R}^m\rightarrow\mathbb{R}^n $$
を $F$ の点 $x$ の周りでの $\varphi,\psi$ による 座標表示(coordinate representation) という。
$f:\mathbb{R}^m\rightarrow\mathbb{R}^n$ の微分可能性の定義を復習する。
定義4.2 $V,W$ をバナッハ空間(線型空間であって完備な距離を持つ)の間の写像 $f:V\rightarrow W$ が点 $a\in V$ で 微分可能(differentiable) であるとは
$$ \lim_{h\rightarrow 0}\frac{||f(a+h)-f(a)-\mathrm{D}f(a)[h]||}{||h||}=0 $$</description></item><item><title>5. 多様体の構成方法</title><link>https://nineties.github.io/manifold-optimization/5-construction/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/5-construction/</guid><description>多様体から新しい多様体を作る方法として、直和、積多様体、商多様体について説明する。
定義5.1: 多様体の直和 次元の等しい多様体 $(\mathcal{M},\mathcal{A}^+),(\mathcal{N},\mathcal{B}^+)$ に対して
$$ (\mathcal{M}\sqcup\mathcal{N},(\mathcal{A}\sqcup\mathcal{B})^+)$$
も同じ次元の多様体となる。これを $\mathcal{M},\mathcal{N}$ の 直和(direct sum) という。
直和は、2つの多様体を持ってきてそれらで1つの多様体であるというだけの話なので構成としては特に面白くないが、商多様体を構成する前段で構成したりする。
定義5.2: 積多様体 $m$ 次元多様体 $(\mathcal{M},\mathcal{A}^+)$、 $n$ 次元多様体 $(\mathcal{N},\mathcal{B}^+)$ に対して $$\mathcal{A}\times\mathcal{B}=\{(U\times V,\varphi\times\psi)\mid(U,\varphi)\in\mathcal{A}, (V,\psi)\in\mathcal{B}\}$$ $$\varphi\times\psi:U\times V\rightarrow\mathbb{R}^m\times\mathbb{R}^n:(x,y)\mapsto(\varphi(x),\psi(y)) $$ とした時、 $$(\mathcal{M}\times\mathcal{N},(\mathcal{A}\times\mathcal{B})^+)$$ は $m+n$ 次元多様体となる。これを 積多様体(product manifold) という。
例えば、ユークリッド空間$\mathbb{R}^m$ は$\mathbb{R}$ 複数個の積多様体 $\mathbb{R}^m\simeq\mathbb{R}\times\mathbb{R}\times\cdots\mathbb{R}$ である。一次元球面 $S^1$ と $\mathbb{R}$ の積 $S^1\times\mathbb{R}$ は円柱、 $S^1\times S^1$ は2トーラスといった感じで様々な多様体が積多様体として構成される。
定義5.3: 商多様体 ${\sim}$ を $\mathcal{M}$ 上の同値関係とする。 多様体 $(\mathcal{M},\mathcal{A}^+)$ から多様体 $(\mathcal{M}/{\sim},\mathcal{B}^+)$ への自然な全射が沈め込みとなるとき、$(\mathcal{M}/{\sim},\mathcal{B}^+)$ を$\mathcal{M}$ の ${\sim}$ による 商多様体(quotient manifold) という。</description></item><item><title>6. 接ベクトル空間</title><link>https://nineties.github.io/manifold-optimization/6-tangent/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/6-tangent/</guid><description>多様体上でニュートン法などの最適化アルゴリズムを実行する為には、点 $x\in\mathcal{M}$ で勾配や方向微分に相当するものを計算できる必要がある。多様体 $\mathcal{M}$ 上の実数値関数 $f:\mathcal{M}\rightarrow\mathbb{R}$ の点 $x\in\mathcal{M}$ での方向 $\eta$ についての方向微分は、多様体上の点について加法が定義されていないので
$$ \mathrm{D}{f}(x)[\eta] = \lim_{t\rightarrow 0}\frac{f(x+t\eta)-f(x)}{t} $$
といった感じでは書けない。方向 $\eta$ をどう表現するかも明らかではない。 適当なチャートを用いれば、ユークリッド空間の関数になるのでこれらを計算する事ができるが、チャートの選び方に結果が依存してしまう為、定義としては使い勝手が良くない。
そこで接ベクトルや接ベクトル空間といった概念が登場するのだが、チャートの選び方に依存しない定義とするために、非常に巧妙なものとなっている。その為とても難しい(と私は感じた)。
接ベクトルの定義にはいくつかの流儀があるみたいで、今回参考にしているAbsil本では多様体上の実関数に対する微分作用素を接ベクトルとする定義を採用している。この定義は理屈としては分かるものの、図形的な直感を(私は)なかなか得られなかったので、このノートでは別のもっと直感的に理解しやすい(と私が思う)定義から出発したいと思う。
接ベクトルは多様体上を滑らかに移動する点の速度ベクトルとして理解する事が出来る。
定義6.1: 曲線 $\varepsilon&amp;gt;0$ の時、滑らかな写像 $\gamma:(-\varepsilon,\varepsilon)\rightarrow\mathcal{M}$ を $\mathcal{M}$ 上の 曲線(curve) という。
曲線の定義域は開集合であればなんでも良いが、今は $t=0$ 付近にしか興味がないのでこう書く事にする。
ここで適当なチャートを選んで $\gamma$ を座標表示すれば、$x=\gamma(0)$ における速度ベクトルを求める事が出来るが、チャートの選び方に依存してしまう。そこで、 $x$ を通りこの点で同じ運動をしている曲線の集合 を速度ベクトル (接ベクトル) として定める。 同じ運動をしているか否かは、点 $x$ の周囲に座標系を貼り付けた時に同じ速度ベクトルになっているか否かで判断できる。
定義6.2: 接ベクトル $t=0$ で点 $x\in\mathcal{M}$ を通る曲線の集合 $$ \mathcal{L}_x = \{\gamma:(-\varepsilon,\varepsilon)\rightarrow\mathcal{M} \mid \gamma(0)=x \}$$ の上の同値関係を $x$ を含むチャート $(U,\varphi)$ を用いて $$ \gamma_1\sim\gamma_2\Longleftrightarrow \frac{\mathrm{d}(\varphi\circ\gamma_1)}{\mathrm{d}t}(0) = \frac{\mathrm{d}(\varphi\circ\gamma_2)}{\mathrm{d}t}(0) $$ と定める。これはチャートの選び方に寄らない。 $\mathcal{L}_x/{\sim}$ の元を $\mathcal{M}$ の点 $x$ での 接ベクトル(tangent vector) という。</description></item><item><title>7. 微分</title><link>https://nineties.github.io/manifold-optimization/7-derivative/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/7-derivative/</guid><description>定義4.2 で定めたバナッハ空間の間の写像 $f:V\rightarrow W$ の微分 $\mathrm{D}f(a)[-]$ を接ベクトル空間に対して一般化する。
定義7.1 多様体の間の滑らかな写像 $F:\mathcal{M}\rightarrow\mathcal{N}$ と、接ベクトル $v=[\gamma]\in T_x\mathcal{M}$ に対して、 $$\mathrm{D}F(x)[v] := [F\circ\gamma]$$ と定めると $\mathrm{D}F(x)[v]$ は $\mathcal{N}$の$F(x)$ における接ベクトルとなる。この対応
$$ \mathrm{D}F(x):T_x\mathcal{M}\rightarrow T_{F(x)}\mathcal{N}: v\mapsto\mathrm{D}F(x)[v] $$
は線型写像になり、これを $F$ の $x$ における 微分(differential) という。
多様体上においても以下の連鎖律が成立する。
命題7.2 滑らかな写像 $F:\mathcal{L}\rightarrow\mathcal{M},\ G:\mathcal{M}\rightarrow{N}$ と、点 $x\in\mathcal{L}$、接ベクトル $v\in T_x\mathcal{L}$ に対して、 $$ \mathrm{D}(G\circ F)(x)[v] =\mathrm{D}G(F(x))[\mathrm{D}F(x)[v]] $$
$\mathcal{M},\mathcal{N}$ がベクトル空間の場合は同型 $T_x\mathcal{M}\simeq\mathcal{M}, T_{F(x)}\mathcal{N}\simeq\mathcal{N}$ によって $v$ は普通のベクトル $v\in\mathcal{M}$ となり、 $F$ の微分は
$$ \mathrm{D}F(x)[v] = \lim_{t\rightarrow 0}\frac{F(x+vt)-F(x)}{t} $$</description></item><item><title>8. リーマン多様体、勾配</title><link>https://nineties.github.io/manifold-optimization/8-riemann/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/8-riemann/</guid><description>前節までで多様体上で定義された滑らかな関数 $f:\mathcal{M}\rightarrow\mathbb{R}$ の方向微分は計算できるようになったが、最適化アルゴリズムを実行する為には 勾配(gradient) が必要である。そして、勾配を定義する為には多様体に リーマン計量(Riemannian metric) という構造を入れる必要がある。
勾配を定めるのに何故リーマン計量が必要なのか戸惑うかもしれない(私は最初は戸惑った)。接ベクトル空間 $T_x\mathcal{M}$ を定めることができて各接ベクトル $v\in T_x\mathcal{M}$ に沿った方向微分を計算できるのに、何故勾配を定める事ができないのか？という事である。
そもそも勾配とはなんであるかというと、ベクトル解析における概念では $f$ の変化率が最大となる方向を向いていて、ノルムがその変化率であるようなベクトル指すのだった。多様体の上での勾配はこれを一般化した概念としたいが、接ベクトル $v\in T_x\mathcal{M}$ の 長さ が与えられていないので、変化率が最大つまり 同じ距離だけ進んだ時 に $f$ が最も大きく変化する方向を定める事ができない。リーマン計量を入れれば、ベクトルの長さなどの幾何学的性質を多様体の上で定義する事が可能になる為、勾配も定義する事が可能になる。
定義8.1: 内積 実ベクトル空間 $V$ に対して定められた写像 $\langle\cdot ,\cdot\rangle:V\times V\rightarrow\mathbb{R}$ が以下の性質を満たすとき、これを 内積(inner product) という。
任意の $u,v,w\in V,a\in\mathbb{R}$ に対して
対称性: $\langle u,v\rangle = \langle v,u\rangle$ 第一引数についての線型性: $\langle au+v, w\rangle =a\langle u, w\rangle +\langle v, w\rangle$ 正定値性: $u\neq 0\Rightarrow \langle u, u\rangle &amp;gt; 0$ 第二引数についての線型性は対称性と第一引数についての線型性より導かれる。 $\langle 0, 0\rangle =\langle 0+0, 0\rangle =\langle 0, 0\rangle + \langle 0, 0\rangle $ より $\langle 0, 0\rangle =0$ なので $\langle u, u\rangle \geq 0$ である事と、非退化性 $\langle u, u\rangle =0\Rightarrow u=0$ も得られる。</description></item><item><title>9. レトラクション</title><link>https://nineties.github.io/manifold-optimization/9-retractions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://nineties.github.io/manifold-optimization/9-retractions/</guid><description>各点 $x\in\mathcal{M}$ での勾配が定められるようになったので、次は $\mathcal{M}$ 上で点を動かして最小値を探索する方法を考える。
ユークリッド空間 $\mathbb{R}^n$ の関数 $f:\mathbb{R}^n\rightarrow\mathbb{R}$ に対する 直線探索法(line-search method) とは点 $x_0\in\mathbb{R}^n$ から出発して、更新式
$$ x_{k+1}=x_k + t_kv_k $$
を反復し $f$ の極小値を求める方法である。ここで $v_k$ は 探索方向(search direction) と呼ばれるベクトル、 $t_k$ は ステップサイズ(step size) と呼ばれるスカラーであって、これらをどのように求めるかによって様々な最適化アルゴリズムが存在する。
多様体 $\mathcal{M}$ 上で同様の探索を行う事を考える。つまり $x_k \in\mathcal{M}$ から $v_k\in T_{x_k}\mathcal{M}$ の方向に探索を進めるということ行いたいわけであるが、 一般の多様体上では直線というものを考えることは出来ないので、
$$ \gamma(0) = x_k,\quad\dot{\gamma}(0)=v_k $$
を満たす曲線 $\gamma$ に沿って探索を行う。ユークリッド空間での直線探索法と異なり、曲線 $\gamma$ の選び方という自由度が増えている。
このような $\gamma$ は条件さえ満たせばどのように構成しても良いが、レトラクションという接バンドルから多様体への写像を用いるのが一般的である。
定義9.1: レトラクション 接バンドル $T\mathcal{M}$ から $\mathcal{M}$ への滑らかな写像 $R:T\mathcal{M}\rightarrow\mathcal{M}$ で以下の条件を満たすものを レトラクション(retraction) という。 $R$ の $T_x\mathcal{M}$ への制限を $R_x:T_x\mathcal{M}\rightarrow\mathcal{M}$ と書く。</description></item></channel></rss>